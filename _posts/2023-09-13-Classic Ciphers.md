---
title: Class Ciphers
date: 2023-09-13 03:11:51 +09:00
categories: [Study, Crypto]
tags: [symmetric, key]     # TAG names should always be lowercase
math: true
mermaid: true
---

> A. Shift Cipher<br>
	- shift_encrypt(key, msg): It takes a key and a message (example 'abc') and outputs a ciphertext (example 'def').<br>
	- shift_decrypt(key, ctx): It takes a key and a ciphertext and outputs a plaintext.<br>
    B. Vigenere Cipher<br>
    	- vigenere_genkey(n): It takes the length of key and outputs a key.<br>
        - vigenere_encrypt(key, msg): It takes the key generated by vigenere_genkey and a plaintext, and then it outputs a ciphertext.<br>
        - vigenere_decrypt(key, ctx): It takes the key generated by vigenere_genkey and a ciphertext, and then it outputs a plaintext.<br>
C. LFSR Cipher<br>
	- lfsr_genkey(m): It takes the length of lfsr and outputs a key that contains constants {c_i}\_{i=0}^{m-1} and initial values {x\_i}\_{i=1}^{m} where 0 <= c_i < 26 and 0 <= x_i < 26.<br>
	- lfsr_encrypt(key, msg): It takes the key generated by lfsr_genkey and a plaintext, and then it outputs a ciphertext.<br>
	- lfsr_decrypt(key, ctx): It takes the key and a ciphertext, and then it outputs a plaintext.<br>

> When implementing LFSR Cipher, you should use mod 26 instead of mod 2. You also use addition (+) and subtraction (-) instead of XOR.

## PART A) Shift Cipher
### - shift_encrypt(key, msg)
- í‚¤ì™€ ë©”ì‹œì§€ë¥¼ ì…ë ¥ë°›ì•„ ì•”í˜¸ë¬¸ ì¶œë ¥
- c = x + k mod 26
```python
def shift_encrypt(key, msg): #c = x + k mod 26
    n = key % 26
    ct = msg
    for x in range(len(msg)):
        tmp = ord(msg[x]) + n #ord(): alpha -> ascii
        #chr(): ascii -> aplha           
        ct = ct.replace(msg[x], chr(tmp)) #character change
    return ct
```
Keyë¥¼ ì…ë ¥ ë°›ì•„ mod 26ì„ í•˜ì—¬ nì— ì €ì¥í•œë‹¤.
Plaintextì¸ msgì˜ ê° ë¬¸ìì— ëŒ€í•´ shiftí•˜ê¸° ìœ„í•´ forí•¨ìˆ˜ë¥¼ ì ìš©í–ˆê³ , ë¬¸ìë¥¼ ì•„ìŠ¤í‚¤ì½”ë“œë¡œ ë°”ê¿”ì£¼ëŠ” í•¨ìˆ˜ì¸ ord()í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ në§Œí¼ ë”í•´ì„œ tmpì— ì €ì¥í•œë‹¤. ì´í›„,ë‹¤ì‹œ ì•„ìŠ¤í‚¤ì½”ë“œì—ì„œ ë¬¸ìë¡œ ë³€í™˜í•´ì£¼ëŠ” chr() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ìë¡œ ë³€í™˜í•´ì£¼ê³  replaceí•¨ìˆ˜ë¡œ ê¸°ì¡´ì˜ ë¬¸ìì—´ì˜ ë¬¸ìë¥¼ shiftí•œ ë¬¸ìë¡œ ë°”ê¿”ì¤€ë‹¤.

### - shift_decrypt(key, ctx)
- í‚¤ì™€ ì•”í˜¸ë¬¸ì„ ì…ë ¥ë°›ì•„ ë³µí˜¸ë¬¸ ì¶œë ¥
- x = c â€“ k mod 26
```python
def shift_decrypt(key, ctx): #x = c - k mod 26
    n = key % 26
    msg = ctx
    for x in range(len(ctx)):
        tmp = ord(ctx[x]) - n #ord(): alpha -> ascii
        #chr(): ascii -> aplha           
        msg = msg.replace(ctx[x], chr(tmp)) #character change
    return (msg)
```
shift_decryptëŠ” shift_encryptí•¨ìˆ˜ì™€ ìœ ì‚¬í•˜ê²Œ ì§„í–‰ë˜ë©° ë³µí˜¸í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ord()í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ê³  nì„ ë¹¼ì„œ tmpì— ì €ì¥í•œë‹¤. ì´í›„ shift_encryptí•¨ìˆ˜ì—ì„œ ë¬¸ìì—´ì„ êµ¬ì„±í•˜ëŠ” ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ plaintextë¥¼ ë§Œë“ ë‹¤.
![](/assets/img/_POST/Classic Ciphers/image1.png)

## PART B) Vigenere Cipher
### - vigenere_genkey(n)
- í‚¤ì˜ ê¸¸ì´ë¥¼ ì…ë ¥ë°›ì•„ í‚¤ ì¶œë ¥
- ğ¾ğ¸ğ‘Œ(âˆ’): (ğ‘˜1, ğ‘˜2, â€¦ , ğ‘˜ğ‘›), ğ‘›
```python
def vigenere_genkey(n):
    import random
    import string
    key = ""
    for i in range(n):
        key += str(random.choice(string.ascii_lowercase))
    return(key)
```
Keyë¥¼ ëœë¤í•˜ê²Œ ì¶”ì¶œí•˜ê¸° ìœ„í•´ì„œ randomëª¨ë“ˆê³¼ stringëª¨ë“ˆì„ ì‚¬ìš©í•œë‹¤. Keyë¥¼ ë¬¸ìì—´ë¡œ ë°˜í™˜í•  ê²ƒì´ê¸° ë•Œë¬¸ì— keyë¥¼ ë¹ˆë¬¸ìì—´ í˜•íƒœë¡œ ì´ˆê¸°í™”í•œë‹¤. Rê¸¸ì´ nì˜ ëœë¤í•œ ë¬¸ìì—´ì„ ì¶”ì¶œí•˜ê¸° ìœ„í•´ forë¬¸ì„ ì‚¬ìš©í•˜ì˜€ê³  string.ascii_lowercase()í•¨ìˆ˜ì™€ random.choice()í•¨ìˆ˜ë¡œ ì†Œë¬¸ìë¥¼ ëœë¤í•˜ê²Œ ì¶”ì¶œí•˜ì—¬ keyì— ì €ì¥ì‹œì¼°ë‹¤.

### - vigenere_encrypt(key, msg)
- vigenere_genkeyì—ì„œ ìƒì„±ëœ í‚¤ì™€ ì¼ë°˜ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ë°›ì•„ ì•”í˜¸ë¬¸ ì¶œë ¥
- ğ¸ğ‘ğ¶(ğ‘‹): (ğ‘1, ğ‘2, â€¦ , ğ‘ğ‘›) where ğ‘ğ‘– = ğ‘¥ğ‘– + ğ‘˜ğ‘– mod 26
```python
def vigenere_encrypt(key, msg):
    ct = msg
    for x in range(len(msg)):
        n = (ord(key[x%len(key)])-ord('a'))% 26
        tmp = ord(msg[x]) + n #ord(): alpha -> ascii
        #chr(): ascii -> aplha
        List_ct = list(ct)
        List_ct[x] = chr(tmp) 
        ct = "".join(List_ct) #replaceëŠ” msg[x]ì™€ ê°™ì€ ëª¨ë“  ë¬¸ìì— ëŒ€í•´ ë³€ê²½ë¨.
        # í•´ë‹¹ cipherëŠ” ê° ë¬¸ìë§ˆë‹¤ keyê°€ ë³€ê²½ë˜ë¯€ë¡œ replaceë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ
        # ì£¼ì–´ì§„ ë¬¸ìì—´ì„ ëª©ë¡ìœ¼ë¡œ ë³€í™˜í•˜ê³ , ì´ì „ë¬¸ìëŠ” ì§€ì •ëœ ì¸ë±ìŠ¤ì˜ ìƒˆë¬¸ìë¡œ ëŒ€ì²´
        #character change
    return ct
```
Vigenere encryptë¥¼ í•˜ê¸°ìœ„í•´ keyì˜ ë¬¸ìë¥¼ ì•„ìŠ¤í‚¤ì½”ë“œë¡œ ë³€í™˜í•œ í›„ ë¬¸ì aë¥¼ ë¹¼ì„œ ìˆ«ì keyë¥¼ ë§Œë“¤ì—ˆë‹¤. í•´ë‹¹ keyë§Œí¼ ë”í•´ì„œ shiftí•´ì£¼ê³  ë¬¸ìì—´ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤. ì´ë•Œ shift_encryptì—ì„œëŠ” replace()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ, ì´ëŠ” msg[x]ì™€ ê°™ì€ ëª¨ë“  ë¬¸ìë¥¼ ì¹˜í™˜í•˜ê¸° ë•Œë¬¸ì— ê° ë¬¸ìë§ˆë‹¤ keyê°€ ë³€ê²½ë˜ëŠ” vigenere cipherì—ëŠ” ì ì ˆí•˜ì§€ ì•Šë‹¤. ë”°ë¼ì„œ ì£¼ì–´ì§„ ë¬¸ìì—´ì„ listë¡œ ë³€í™˜í•˜ê³  ì´ì „ ë¬¸ìëŠ” ì§€ì •ëœ indexì˜ ìƒˆë¡œìš´ ë¬¸ìë¡œ ëŒ€ì²´í•œë‹¤.

### - vigenere_decrypt(key, ctx)
- vigenere_genkeyì—ì„œ ìƒì„±ëœ í‚¤ì™€ ì•”í˜¸ë¬¸ì„ ì…ë ¥ë°›ì•„ ë³µí˜¸ë¬¸ ì¶œë ¥
- ğ·ğ¸ğ¶(ğ¶): (ğ‘¥1, ğ‘¥2, â€¦ , ğ‘¥ğ‘›) where ğ‘¥ğ‘– = ğ‘ğ‘– âˆ’ ğ‘˜ğ‘– mod 26 
```python
def vigenere_decrypt(key, ctx):
    msg = ctx
    for x in range(len(ctx)):
        n = (ord(key[x%len(key)])-ord('a'))% 26
        tmp = ord(ctx[x]) - n #ord(): alpha -> ascii
        #chr(): ascii -> aplha
        List_msg = list(msg)
        List_msg[x] = chr(tmp) 
        msg = "".join(List_msg)
    return msg
```
Vigenere decryptëŠ” encryptí•¨ìˆ˜ì™€ ìœ ì‚¬í•˜ê³  ë‹¨ì§€, ë”í•˜ê¸°ê°€ ì•„ë‹Œ ë¹¼ê¸°ë¥¼ í•˜ì—¬ ë³µí˜¸í™”ë¥¼ ì§„í–‰í•œë‹¤.

![](/assets/img/_POST/Classic Ciphers/image2.png)

## PART C) LFSR Cipher
### - lsfr_genkey(m)
- lsfrì˜ ê¸¸ì´ë¥¼ ì…ë ¥ë°›ì•„ í‚¤ë¥¼ ìƒì„±
-  inital valueì„¤ì •<br>
	{x\_i}\_{i=1}^{m}<br>
    {c\_i}_{i=0}^{m-1}<br>
- x_{ğ‘›+ğ‘š} = c0_xğ‘› + c1\_{xğ‘›+1} + c2\_{xğ‘›+2} + â‹¯ + cğ‘š\_{xğ‘›+ğ‘š} ğ‘šğ‘œğ‘‘ 2<br>
```python
def lfsr_genkey(m):
    import random
    x =[-1]
    c =[]
    for i in range(1, m+1):
        x.append(random.randrange(0, 26))
        #{x_i}_{i=1}^{m} 
    for i in range(m):
        c.append(random.randrange(0, 26))
        #{c_i}_{i=0}^{m-1}
    # intial value, c_i x_i

    for n in range(1, 26):
        tmp = 0
        i = 0
        j = n
        while i < m+n-1 and j < m+n:
            tmp += (c[i]*x[j]) % 26  
            i+=1
            j+=1
        tmp = tmp%26
        x.append(tmp)

    key = ""
    for i in range(1, 26+m):
        tmp = x[i] + ord('a')
        key += chr(tmp)

    return key
```
***í‚¤ë¥¼ ìƒì„±í•  ë•Œ mod 2ê°€ ì•„ë‹Œ mod 26ì„ ì‚¬ìš©í•œë‹¤.*** ë¨¼ì € ì´ˆê¸°ê°’ì„ ì„¤ì •í•˜ê¸° ìœ„í•´, randomí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ 0<=x<26ì˜ xë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì¸ë±ìŠ¤ë¥¼ i=1ë¶€í„° mê¹Œì§€ ì„¤ì •í•˜ê¸° ìœ„í•´ xë¦¬ìŠ¤íŠ¸ì˜ x[0]ì— ë¨¼ì € -1ì„ ì‚½ì…í•œ í›„ ëœë¤ ê°’ì„ ì…ë ¥í–ˆë‹¤. 0<=c<26 ë²”ìœ„ì˜ cë¥¼ mê°œë¥¼ ì¸ë±ìŠ¤ 0ë¶€í„° m-1ê¹Œì§€ ëœë¤ ê°’ì„ ì…ë ¥ ë°›ì•˜ë‹¤. ì´í›„ x_{ğ‘›+ğ‘š} = c0_xğ‘› + c1\_{xğ‘›+1} + c2\_{xğ‘›+2} + â‹¯ + cğ‘š\_{xğ‘›+ğ‘š} ğ‘šğ‘œğ‘‘ 2 ì˜ ì‹ì„ ì´ìš©í•˜ì—¬ x\_{ğ‘›+ğ‘š}ê¹Œì§€ì˜ x ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤. ì´ xê°’ë“¤ì„ ë¬¸ìì—´ keyë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ord()í•¨ìˆ˜ì™€ chr()í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.

### - lsfr_encrypt(key, msg)
- lsfr_genkeyí•¨ìˆ˜ì—ì„œ ìƒì„±ëœ í‚¤ì™€ ì¼ë°˜í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ë°›ì•„ ì•”í˜¸ë¬¸ ì¶œë ¥
- ğ¸ğ‘ğ¶(ğ‘‹): (ğ‘1, ğ‘2, â€¦ , ğ‘ğ‘›) where ğ‘\_ğ‘– = ğ‘¥\_ğ‘– ğ‘¥ğ‘œğ‘Ÿ ğ‘˜ğ‘– ğ‘šğ‘œğ‘‘ 2
```python
def lsfr_encrypt(key,msg):
    ct = msg
    for x in range(len(msg)):
        n = (ord(key[x%len(key)])-ord('a'))% 26
        tmp = ord(msg[x]) + n
        List_ct = list(ct)
        List_ct[x] = chr(tmp) 
        ct = "".join(List_ct)
    return ct
```
**ì•”í˜¸í™”ë¥¼ í•  ë•Œ XORì´ ì•„ë‹Œ +ë¥¼ ì´ìš©í–ˆë‹¤.** ê¸°ì¡´ì˜ LFSR cipherëŠ” XORì„ ì´ìš©í•˜ì—¬ ì•”í˜¸í™”ë¥¼ ì§„í–‰í•˜ì§€ë§Œ í•´ë‹¹ ê³¼ì œì—ì„œëŠ” ë§ì…ˆì„ ì´ìš©í•˜ì—¬ ì•”í˜¸í™”ë¥¼ í•˜ì˜€ë‹¤.

### - lsfr_decrypt(key, ctx)
- lsfr_decryptí•¨ìˆ˜ì—ì„œ ìƒì„±ëœ í‚¤ì™€ ì•”í˜¸ë¬¸ì„ ì…ë ¥ë°›ì•„ ë³µí˜¸ë¬¸ ì¶œë ¥
- ğ·ğ¸ğ¶(ğ¶): (ğ‘¥1, ğ‘¥2, â€¦ , ğ‘¥ğ‘›) where x\_ğ‘– = ğ‘\_ğ‘– ğ‘¥ğ‘œğ‘Ÿ ğ‘˜ğ‘– ğ‘šğ‘œğ‘‘ 2
```python
def lsfr_decrypt(key, ctx):
    msg = ctx
    for x in range(len(ctx)):
        n = (ord(key[x%len(key)])-ord('a'))% 26
        tmp = ord(ctx[x]) - n
        List_msg = list(msg)
        List_msg[x] = chr(tmp) 
        msg = "".join(List_msg)
    return msg
```
**ë³µí˜¸í™”ë¥¼ í•  ë•Œ XORì´ ì•„ë‹Œ -ë¥¼ ì´ìš©í–ˆë‹¤.** ê¸°ì¡´ì˜ LFSR cipherëŠ” XORì„ ì´ìš©í•˜ì—¬ ë³µí˜¸í™”ë¥¼ ì§„í–‰í•˜ì§€ë§Œ í•´ë‹¹ ê³¼ì œì—ì„œëŠ” ëº„ì…ˆì„ ì´ìš©í•˜ì—¬ ë³µí˜¸í™”ë¥¼ í•˜ì˜€ë‹¤.


![](/assets/img/_POST/Classic Ciphers/image3.png)
